# í˜ë¥´ì†Œë‚˜ & ê¸°ì–µ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

> ìµœì¢… ì—…ë°ì´íŠ¸: 2024-12-03
> ë²„ì „: 2.0 (ë¦¬íŒ©í† ë§ ê³„íš)

---

## ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [í˜„ì¬ ìƒíƒœ ë¶„ì„](#2-í˜„ì¬-ìƒíƒœ-ë¶„ì„)
3. [ë¬¸ì œì  ì‹ë³„](#3-ë¬¸ì œì -ì‹ë³„)
4. [ëª©í‘œ ì•„í‚¤í…ì²˜](#4-ëª©í‘œ-ì•„í‚¤í…ì²˜)
5. [ë°ì´í„° ëª¨ë¸ ìƒì„¸](#5-ë°ì´í„°-ëª¨ë¸-ìƒì„¸)
6. [API ì„¤ê³„](#6-api-ì„¤ê³„)
7. [ê¸°ì–µ ë©”ë‰´ UI/UX](#7-ê¸°ì–µ-ë©”ë‰´-uiux)
8. [ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš](#8-ë§ˆì´ê·¸ë ˆì´ì…˜-ê³„íš)
9. [êµ¬í˜„ ë¡œë“œë§µ](#9-êµ¬í˜„-ë¡œë“œë§µ)

---

## 1. ê°œìš”

### 1.1 ì‹œìŠ¤í…œ ëª©ì 

AI ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ ë…¸ë²¨ì—ì„œ **í˜ë¥´ì†Œë‚˜(ìºë¦­í„°)**ì™€ **ìœ ì €** ê°„ì˜ ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ê³ ,
ìƒí˜¸ì‘ìš©ì„ í†µí•´ ë°œìƒí•˜ëŠ” **ê¸°ì–µ**, **ì§„í–‰ë„**, **ê´€ê³„ ë°œì „**ì„ ì¶”ì í•˜ëŠ” ì‹œìŠ¤í…œ.

### 1.2 í•µì‹¬ ì›ì¹™

| ì›ì¹™ | ì„¤ëª… |
|------|------|
| **Origin ë¶ˆë³€ì„±** | ì˜¤ë¦¬ì§„ í˜ë¥´ì†Œë‚˜ ë°ì´í„°ëŠ” ì ˆëŒ€ ë³€ê²½ë˜ì§€ ì•ŠìŒ. ìƒˆ ìœ ì €ëŠ” í•­ìƒ ì›ë³¸ ì„¤ì •ì—ì„œ ì‹œì‘ |
| **ìœ ì €ë³„ ë¶„ê¸°** | ê° ìœ ì €ì˜ ì„ íƒê³¼ ìƒí˜¸ì‘ìš©ì— ë”°ë¼ í˜ë¥´ì†Œë‚˜ê°€ ë…ë¦½ì ìœ¼ë¡œ ì§„í™” |
| **ê¸°ì–µ ì˜ì†ì„±** | ì¤‘ìš”í•œ ìˆœê°„ë“¤ì€ ê¸°ì–µìœ¼ë¡œ ì €ì¥ë˜ì–´ ì–¸ì œë“  íšŒìƒ ê°€ëŠ¥ |
| **ì§„í–‰ë„ ì¶”ì ** | ì‹œë‚˜ë¦¬ì˜¤, ê´€ê³„, í•´ê¸ˆ ì½˜í…ì¸  ë“± ëª¨ë“  ì§„í–‰ ìƒí™©ì„ í†µí•© ê´€ë¦¬ |

### 1.3 ìš©ì–´ ì •ì˜

| ìš©ì–´ | ì •ì˜ |
|------|------|
| **Origin Persona** | ì›ë³¸ í˜ë¥´ì†Œë‚˜. ì„¸ê³„ê´€, ì„±ê²©, ì™¸ëª¨ ë“± ì´ˆê¸° ì„¤ì •ê°’. ë¶ˆë³€ |
| **User Persona Instance** | íŠ¹ì • ìœ ì €ì™€ ì—°ê²°ëœ í˜ë¥´ì†Œë‚˜ ì¸ìŠ¤í„´ìŠ¤. ìƒí˜¸ì‘ìš©ì— ë”°ë¼ ì§„í™” |
| **Memory** | ìœ ì €-í˜ë¥´ì†Œë‚˜ ê°„ ì˜ë¯¸ìˆëŠ” ìƒí˜¸ì‘ìš© ê¸°ë¡ |
| **Milestone** | ê´€ê³„ ë°œì „ì˜ ì£¼ìš” ì´ì •í‘œ (ì²« ë§Œë‚¨, ê³ ë°±, ì—°ì¸ ë“±) |
| **Progress** | ìŠ¤í† ë¦¬/ì‹œë‚˜ë¦¬ì˜¤ ì§„í–‰ ìƒíƒœ |

---

## 2. í˜„ì¬ ìƒíƒœ ë¶„ì„

### 2.1 í˜„ì¬ í…Œì´ë¸” êµ¬ì¡°

```
í˜„ì¬ DB ìŠ¤í‚¤ë§ˆ (2024-12-03 ê¸°ì¤€)
================================

[Origin ë°ì´í„° - ê³µìœ ë¨]
â”œâ”€â”€ personas                 (5 rows) - ê¸°ë³¸ í”„ë¡œí•„
â”œâ”€â”€ persona_core            (1 row)  - í•µì‹¬ ì„±ê²© (junë§Œ)
â”œâ”€â”€ persona_traits          (5 rows) - ì„±ê²© íŠ¹ì„±
â”œâ”€â”€ persona_worldview       (5 rows) - ì„¸ê³„ê´€
â”œâ”€â”€ scenario_templates      (1 row)  - ì‹œë‚˜ë¦¬ì˜¤ í…œí”Œë¦¿
â””â”€â”€ episode_templates       (0 rows) - ì—í”¼ì†Œë“œ í…œí”Œë¦¿

[ìœ ì €ë³„ ë°ì´í„°]
â”œâ”€â”€ user_persona_relationships (1 row) - ê´€ê³„ ìƒíƒœ
â”œâ”€â”€ persona_memories           (0 rows) - ê¸°ì–µ
â”œâ”€â”€ conversation_sessions      (1 row)  - ëŒ€í™” ì„¸ì…˜
â”œâ”€â”€ conversation_messages      (12 rows) - ëŒ€í™” ë‚´ìš©
â”œâ”€â”€ conversation_summaries     (0 rows) - ëŒ€í™” ìš”ì•½
â””â”€â”€ user_scenario_progress     (0 rows) - ì‹œë‚˜ë¦¬ì˜¤ ì§„í–‰
```

### 2.2 í˜„ì¬ ë°ì´í„° íë¦„

```
[í˜„ì¬ íë¦„ - ë¬¸ì œ ìˆìŒ]

User Request
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  personas í…Œì´ë¸” ì§ì ‘ ì¡°íšŒ              â”‚  â† ëª¨ë“  ìœ ì €ê°€ ê°™ì€ ë°ì´í„°
â”‚  (display_name, avatar_url, bio ë“±)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  user_persona_relationships ì¡°íšŒ        â”‚  â† ê´€ê³„ë§Œ ë¶„ë¦¬ë¨
â”‚  (affection, relationship_stage)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Response (í˜¼í•©ëœ ë°ì´í„°)
```

### 2.3 í˜„ì¬ `user_persona_relationships` ì»¬ëŸ¼

```sql
-- í˜„ì¬ êµ¬ì¡°
user_persona_relationships
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ user_id (UUID)
â”œâ”€â”€ persona_id (TEXT)
â”œâ”€â”€ affection (INTEGER, default 0)
â”œâ”€â”€ relationship_stage (TEXT, default 'stranger')
â”œâ”€â”€ trust_level (INTEGER, default 50)
â”œâ”€â”€ intimacy_level (INTEGER, default 0)
â”œâ”€â”€ tension_level (INTEGER, default 0)
â”œâ”€â”€ completed_episodes (TEXT[])
â”œâ”€â”€ unlocked_episodes (TEXT[])
â”œâ”€â”€ story_flags (JSONB)
â”œâ”€â”€ total_messages (INTEGER)
â”œâ”€â”€ total_choices_made (INTEGER)
â”œâ”€â”€ premium_choices_made (INTEGER)
â”œâ”€â”€ last_interaction_at (TIMESTAMPTZ)
â”œâ”€â”€ last_persona_initiated_at (TIMESTAMPTZ)
â”œâ”€â”€ memorable_moments (JSONB)
â”œâ”€â”€ first_interaction_at (TIMESTAMPTZ)
â”œâ”€â”€ longest_conversation_length (INTEGER)
â”œâ”€â”€ shared_secrets_count (INTEGER)
â”œâ”€â”€ conflicts_resolved (INTEGER)
â”œâ”€â”€ user_nickname (TEXT)          -- í˜ë¥´ì†Œë‚˜ê°€ ìœ ì € ë¶€ë¥´ëŠ” ë³„ëª…
â”œâ”€â”€ persona_nickname (TEXT)       -- ìœ ì €ê°€ í˜ë¥´ì†Œë‚˜ ë¶€ë¥´ëŠ” ë³„ëª…
â”œâ”€â”€ is_unlocked (BOOLEAN)
â”œâ”€â”€ unlocked_at (TIMESTAMPTZ)
â”œâ”€â”€ created_at (TIMESTAMPTZ)
â””â”€â”€ updated_at (TIMESTAMPTZ)
```

---

## 3. ë¬¸ì œì  ì‹ë³„

### 3.1 Critical Issues

| # | ë¬¸ì œ | ì˜í–¥ | ì‹¬ê°ë„ |
|---|------|------|--------|
| 1 | **Origin ë°ì´í„° ë³€ê²½ ìœ„í—˜** | `personas` í…Œì´ë¸” ìˆ˜ì • ì‹œ ëª¨ë“  ìœ ì €ì—ê²Œ ì˜í–¥ | ğŸ”´ Critical |
| 2 | **ì§„í™” ìƒíƒœ ë¯¸ì €ì¥** | ìœ ì €ë³„ í˜ë¥´ì†Œë‚˜ ì„±ê²© ë³€í™”ë¥¼ ì €ì¥í•  ê³³ ì—†ìŒ | ğŸ”´ Critical |
| 3 | **í†µí•© ì§„í–‰ë„ ì—†ìŒ** | ì‹œë‚˜ë¦¬ì˜¤/ê´€ê³„/í•´ê¸ˆì„ í•œëˆˆì— ë³¼ ìˆ˜ ì—†ìŒ | ğŸŸ  High |
| 4 | **ê¸°ì–µ ì‹œìŠ¤í…œ ë¯¸í™œìš©** | `persona_memories` í…Œì´ë¸” ë¹„ì–´ìˆìŒ | ğŸŸ  High |
| 5 | **ë§ˆì¼ìŠ¤í†¤ ì •ì˜ ì—†ìŒ** | ê´€ê³„ ë°œì „ ì´ì •í‘œê°€ ì½”ë“œì— í•˜ë“œì½”ë”©ë¨ | ğŸŸ¡ Medium |

### 3.2 ë¬¸ì œ ìƒì„¸

#### ë¬¸ì œ 1: Origin ë°ì´í„° ë³€ê²½ ìœ„í—˜

```
ì‹œë‚˜ë¦¬ì˜¤:
- ìœ ì € Aê°€ Junê³¼ ì¹œë°€í•´ì ¸ì„œ Junì˜ í”„ë¡œí•„ ì‚¬ì§„ì´ "ì›ƒëŠ” ëª¨ìŠµ"ìœ¼ë¡œ ë°”ë€œ
- ì´ ë³€ê²½ì´ `personas.avatar_url`ì— ì§ì ‘ ì €ì¥ë˜ë©´?
- ìƒˆë¡œ ê°€ì…í•œ ìœ ì € Bë„ ì²˜ìŒë¶€í„° "ì›ƒëŠ” ëª¨ìŠµ"ì˜ Junì„ ë³´ê²Œ ë¨ âŒ

í•´ê²° í•„ìš”:
- Origin ë°ì´í„°ì™€ User Instance ë°ì´í„° ë¶„ë¦¬
```

#### ë¬¸ì œ 2: ì§„í™” ìƒíƒœ ë¯¸ì €ì¥

```
ì‹œë‚˜ë¦¬ì˜¤:
- ìœ ì €ê°€ Junê³¼ 100íšŒ ëŒ€í™”, ë¹„ë°€ì„ ê³µìœ , ì‹¸ìš°ê³  í™”í•´
- Junì˜ ì„±ê²©ì´ ì ì  ìœ ì €ì—ê²Œ ì—´ë¦¼ (ë§íˆ¬ ë³€í™”, ë” ì†”ì§í•´ì§)
- í˜„ì¬: ì´ëŸ° "ì§„í™”ëœ ìƒíƒœ"ë¥¼ ì €ì¥í•  ê³³ì´ ì—†ìŒ

í•„ìš”í•œ ë°ì´í„°:
- evolved_personality: { openness: 80, trust: 90, ... }
- behavior_changes: { uses_informal_speech: true, shares_worries: true }
- unlocked_sides: ['vulnerable', 'playful', 'jealous']
```

#### ë¬¸ì œ 3: í†µí•© ì§„í–‰ë„ ì—†ìŒ

```
í˜„ì¬ ë¶„ì‚°ëœ ì§„í–‰ ë°ì´í„°:
- user_persona_relationships.completed_episodes
- user_scenario_progress.status
- unlocked_items (ë³„ë„ í…Œì´ë¸”)
- conversation_sessions (ë³„ë„ í…Œì´ë¸”)

í•„ìš”:
- í•œ ê³³ì—ì„œ "ì´ ìœ ì €ê°€ ì´ í˜ë¥´ì†Œë‚˜ì™€ ì–´ë””ê¹Œì§€ ì§„í–‰í–ˆëŠ”ì§€" íŒŒì•…
```

---

## 4. ëª©í‘œ ì•„í‚¤í…ì²˜

### 4.1 ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     LAYER 1: ORIGIN (ë¶ˆë³€)                       â”‚
â”‚                   ëª¨ë“  ìœ ì €ê°€ ê³µìœ í•˜ëŠ” ì›ë³¸ ë°ì´í„°                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   personas   â”‚  â”‚ persona_core â”‚  â”‚   persona_traits     â”‚  â”‚
â”‚  â”‚  (í”„ë¡œí•„)    â”‚  â”‚  (í•µì‹¬ì„±ê²©)   â”‚  â”‚    (ì„±ê²©íŠ¹ì„±)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  persona_worldview   â”‚  â”‚     scenario_templates         â”‚  â”‚
â”‚  â”‚     (ì„¸ê³„ê´€)          â”‚  â”‚       (ì‹œë‚˜ë¦¬ì˜¤)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              relationship_milestones (NEW)              â”‚    â”‚
â”‚  â”‚                  (ë§ˆì¼ìŠ¤í†¤ ì •ì˜)                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    [ìœ ì € ê°€ì…/ì²« ìƒí˜¸ì‘ìš©]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LAYER 2: USER INSTANCE (ê°€ë³€)                   â”‚
â”‚                    ìœ ì €ë³„ë¡œ ë…ë¦½ì ì¸ ì§„í™” ë°ì´í„°                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            user_persona_progress (NEW/í™•ì¥)             â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  [ê´€ê³„]        [ì§„í–‰ë„]        [ì§„í™”]        [í†µê³„]     â”‚    â”‚
â”‚  â”‚  - stage      - story %      - traits    - messages   â”‚    â”‚
â”‚  â”‚  - affection  - scenarios    - mood      - time       â”‚    â”‚
â”‚  â”‚  - trust      - unlocks      - nickname  - streaks    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                user_memories (í™•ì¥)                     â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  [ê¸°ì–µ íƒ€ì„ë¼ì¸] - ì²«ë§Œë‚¨, ê³ ë°±, ë¹„ë°€ê³µìœ , ê°ˆë“±, í™”í•´...   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              user_journey_stats (NEW)                   â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  [ì „ì²´ ì—¬ì • í†µê³„] - ë§Œë‚œ ìºë¦­í„° ìˆ˜, ì´ ê¸°ì–µ, í”Œë ˆì´ ì‹œê°„   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                       [ëŒ€í™”/ì‹œë‚˜ë¦¬ì˜¤]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LAYER 3: INTERACTION (ê¸°ë¡)                    â”‚
â”‚                     ì‹¤ì‹œê°„ ìƒí˜¸ì‘ìš© ë°ì´í„°                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ conversation_    â”‚  â”‚      conversation_messages       â”‚    â”‚
â”‚  â”‚    sessions      â”‚  â”‚          (ëŒ€í™” ë‚´ìš©)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 user_scenario_progress                   â”‚  â”‚
â”‚  â”‚                   (ì‹œë‚˜ë¦¬ì˜¤ ì§„í–‰)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ë°ì´í„° ì¡°íšŒ íë¦„ (ê°œì„  í›„)

```
[ê°œì„ ëœ íë¦„]

User Request (persona_id: 'jun')
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Origin ë°ì´í„° ì¡°íšŒ (ìºì‹±ë¨)          â”‚
â”‚     personas + persona_core             â”‚
â”‚     â†’ ê¸°ë³¸ê°’ íšë“                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. User Instance ì¡°íšŒ                  â”‚
â”‚     user_persona_progress               â”‚
â”‚     â†’ ì§„í™”ëœ ìƒíƒœ íšë“                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ë°ì´í„° ë³‘í•©                          â”‚
â”‚     Origin + User Override = Final      â”‚
â”‚     â†’ ìœ ì € ë§ì¶¤ í˜ë¥´ì†Œë‚˜ ë°˜í™˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Response (ìœ ì € ë§ì¶¤ ë°ì´í„°)
```

---

## 5. ë°ì´í„° ëª¨ë¸ ìƒì„¸

### 5.1 ì‹ ê·œ í…Œì´ë¸”: `user_persona_progress`

ê¸°ì¡´ `user_persona_relationships`ë¥¼ í™•ì¥í•˜ê±°ë‚˜ ëŒ€ì²´

```sql
CREATE TABLE user_persona_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  persona_id TEXT NOT NULL REFERENCES personas(id),

  -- ========================================
  -- ê´€ê³„ ìƒíƒœ (Relationship State)
  -- ========================================
  relationship_stage TEXT DEFAULT 'stranger',
    -- stranger â†’ acquaintance â†’ friend â†’ close â†’ intimate â†’ lover
  affection INTEGER DEFAULT 0,           -- 0-100 í˜¸ê°ë„
  trust_level INTEGER DEFAULT 50,        -- 0-100 ì‹ ë¢°ë„
  intimacy_level INTEGER DEFAULT 0,      -- 0-100 ì¹œë°€ë„
  tension_level INTEGER DEFAULT 0,       -- 0-100 ê¸´ì¥ë„ (ê°ˆë“± ì‹œ ìƒìŠ¹)

  -- ========================================
  -- ìŠ¤í† ë¦¬ ì§„í–‰ë„ (Story Progress)
  -- ========================================
  main_story_progress INTEGER DEFAULT 0, -- 0-100% ë©”ì¸ ìŠ¤í† ë¦¬
  current_chapter TEXT,                  -- í˜„ì¬ ì±•í„° ID
  chapters_completed TEXT[] DEFAULT '{}',
  scenarios_completed TEXT[] DEFAULT '{}',
  scenarios_in_progress TEXT[] DEFAULT '{}',
  scenarios_unlocked TEXT[] DEFAULT '{}',

  -- ì„ íƒ ê¸°ë¡ (ì£¼ìš” ë¶„ê¸°ì ë§Œ)
  major_choices JSONB DEFAULT '[]',
  -- [{ scenario_id, choice_id, choice_text, timestamp, impact }]

  -- ========================================
  -- í•´ê¸ˆ ì½˜í…ì¸  (Unlocked Content)
  -- ========================================
  secrets_unlocked TEXT[] DEFAULT '{}',    -- í•´ê¸ˆëœ ë¹„ë°€
  gallery_unlocked TEXT[] DEFAULT '{}',    -- í•´ê¸ˆëœ CG/ì´ë¯¸ì§€
  voice_unlocked TEXT[] DEFAULT '{}',      -- í•´ê¸ˆëœ ìŒì„±
  outfits_unlocked TEXT[] DEFAULT '{}',    -- í•´ê¸ˆëœ ì˜ìƒ
  endings_achieved TEXT[] DEFAULT '{}',    -- ë‹¬ì„±í•œ ì—”ë”©

  -- ========================================
  -- í˜ë¥´ì†Œë‚˜ ì§„í™” ìƒíƒœ (Evolved State)
  -- ========================================
  evolved_personality JSONB DEFAULT '{}',
  -- {
  --   openness: 0-100,        // ë§ˆìŒì„ ì—´ì–´ì¤€ ì •ë„
  --   vulnerability: 0-100,   // ì•½í•œ ëª¨ìŠµì„ ë³´ì—¬ì¤€ ì •ë„
  --   playfulness: 0-100,     // ì¥ë‚œì¹˜ëŠ” ì •ë„
  --   possessiveness: 0-100,  // ì§‘ì°©/ì§ˆíˆ¬ ì •ë„
  --   dependency: 0-100       // ì˜ì¡´ë„
  -- }

  unlocked_sides TEXT[] DEFAULT '{}',
  -- ['vulnerable', 'jealous', 'playful', 'possessive', 'caring']

  behavior_flags JSONB DEFAULT '{}',
  -- {
  --   uses_informal_speech: true,
  --   shares_personal_worries: true,
  --   initiates_contact: true,
  --   shows_jealousy: false
  -- }

  current_mood TEXT DEFAULT 'neutral',
  -- neutral, happy, sad, excited, worried, jealous, loving, angry

  -- ========================================
  -- ë³„ëª… (Nicknames)
  -- ========================================
  user_calls_persona TEXT,    -- ìœ ì € â†’ í˜ë¥´ì†Œë‚˜ í˜¸ì¹­ ("ì¤€ì´", "ì˜¤ë¹ ")
  persona_calls_user TEXT,    -- í˜ë¥´ì†Œë‚˜ â†’ ìœ ì € í˜¸ì¹­ ("ìê¸°", "ìš°ë¦¬ íŒ¬")

  -- ========================================
  -- í†µê³„ (Statistics)
  -- ========================================
  total_messages INTEGER DEFAULT 0,
  total_dm_sessions INTEGER DEFAULT 0,
  total_scenarios_played INTEGER DEFAULT 0,
  total_time_spent_minutes INTEGER DEFAULT 0,

  longest_conversation INTEGER DEFAULT 0,    -- ìµœì¥ ì—°ì† ëŒ€í™”
  current_streak_days INTEGER DEFAULT 0,     -- ì—°ì† ì ‘ì†ì¼
  max_streak_days INTEGER DEFAULT 0,         -- ìµœëŒ€ ì—°ì† ì ‘ì†

  -- ========================================
  -- ë§ˆì¼ìŠ¤í†¤ (Milestones)
  -- ========================================
  milestones_achieved JSONB DEFAULT '[]',
  -- [{ milestone_id, achieved_at, affection_at_time }]

  milestone_dates JSONB DEFAULT '{}',
  -- {
  --   first_meeting: "2024-01-01T00:00:00Z",
  --   first_dm: "2024-01-02T00:00:00Z",
  --   became_friends: "2024-01-10T00:00:00Z",
  --   first_confession: null,
  --   became_lovers: null
  -- }

  -- ========================================
  -- íƒ€ì„ìŠ¤íƒ¬í”„
  -- ========================================
  first_interaction_at TIMESTAMPTZ,
  last_interaction_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  UNIQUE(user_id, persona_id)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_upp_user_id ON user_persona_progress(user_id);
CREATE INDEX idx_upp_persona_id ON user_persona_progress(persona_id);
CREATE INDEX idx_upp_relationship ON user_persona_progress(relationship_stage);
CREATE INDEX idx_upp_last_interaction ON user_persona_progress(last_interaction_at);
```

### 5.2 ì‹ ê·œ í…Œì´ë¸”: `user_memories`

ê¸°ì¡´ `persona_memories` í™•ì¥

```sql
CREATE TABLE user_memories (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  persona_id TEXT NOT NULL REFERENCES personas(id),

  -- ========================================
  -- ê¸°ì–µ ë¶„ë¥˜ (Memory Classification)
  -- ========================================
  memory_type TEXT NOT NULL,
  -- ê¸°ì–µ íƒ€ì…:
  -- 'first_meeting'     - ì²« ë§Œë‚¨
  -- 'milestone'         - ê´€ê³„ ë§ˆì¼ìŠ¤í†¤ (ì¹œêµ¬ë¨, ì—°ì¸ë¨ ë“±)
  -- 'confession'        - ê³ ë°± (ì£¼ê±°ë‚˜ ë°›ìŒ)
  -- 'promise'           - ì•½ì†
  -- 'secret_shared'     - ë¹„ë°€ ê³µìœ 
  -- 'conflict'          - ê°ˆë“±/ë‹¤íˆ¼
  -- 'reconciliation'    - í™”í•´
  -- 'special_moment'    - íŠ¹ë³„í•œ ìˆœê°„
  -- 'scenario_ending'   - ì‹œë‚˜ë¦¬ì˜¤ ì—”ë”©
  -- 'gift'              - ì„ ë¬¼ (ì£¼ê±°ë‚˜ ë°›ìŒ)
  -- 'date'              - ë°ì´íŠ¸
  -- 'inside_joke'       - ë‘˜ë§Œì˜ ë†ë‹´
  -- 'important_date'    - ê¸°ë…ì¼

  memory_category TEXT DEFAULT 'story',
  -- 'story'     - ìŠ¤í† ë¦¬ ì§„í–‰ ì¤‘ ë°œìƒ
  -- 'dm'        - DM ëŒ€í™” ì¤‘ ë°œìƒ
  -- 'event'     - ì´ë²¤íŠ¸ì—ì„œ ë°œìƒ
  -- 'system'    - ì‹œìŠ¤í…œ ìë™ ìƒì„±

  -- ========================================
  -- ê¸°ì–µ ë‚´ìš© (Memory Content)
  -- ========================================
  title TEXT NOT NULL,                -- ê¸°ì–µ ì œëª© ("ìƒˆë²½ 3ì‹œì˜ ê³ ë°±")
  summary TEXT NOT NULL,              -- ìš”ì•½ (1-2ë¬¸ì¥)
  full_content JSONB,                 -- ìƒì„¸ ë‚´ìš©
  -- {
  --   context: "ìƒˆë²½ì— DMì´ ì™”ë‹¤...",
  --   dialogue: [{ speaker, text }],
  --   user_choice: "ë‚˜ë„ ì¢‹ì•„í•´",
  --   outcome: "ì—°ì¸ì´ ë˜ì—ˆë‹¤"
  -- }

  -- ========================================
  -- ë¯¸ë””ì–´ (Media)
  -- ========================================
  thumbnail_url TEXT,                 -- ì¸ë„¤ì¼ (CG, ìŠ¤í¬ë¦°ìƒ·)
  cg_urls TEXT[] DEFAULT '{}',        -- ê´€ë ¨ CGë“¤
  voice_url TEXT,                     -- ê´€ë ¨ ìŒì„±

  -- ========================================
  -- ì—°ê²° ì •ë³´ (Relations)
  -- ========================================
  related_scenario_id TEXT,           -- ê´€ë ¨ ì‹œë‚˜ë¦¬ì˜¤
  related_session_id UUID,            -- ê´€ë ¨ ëŒ€í™” ì„¸ì…˜
  triggered_by TEXT,                  -- íŠ¸ë¦¬ê±° ('user_action', 'affection_threshold', 'scenario')

  -- ========================================
  -- ê°ì •/ìƒíƒœ ì •ë³´ (Emotional Data)
  -- ========================================
  emotional_impact INTEGER DEFAULT 5, -- ê°ì •ì  ì˜í–¥ë„ (1-10)
  mood_at_time TEXT,                  -- ë‹¹ì‹œ í˜ë¥´ì†Œë‚˜ ê¸°ë¶„
  affection_at_time INTEGER,          -- ë‹¹ì‹œ í˜¸ê°ë„
  affection_change INTEGER DEFAULT 0, -- í˜¸ê°ë„ ë³€í™”ëŸ‰
  relationship_stage_at_time TEXT,    -- ë‹¹ì‹œ ê´€ê³„ ë‹¨ê³„

  -- ========================================
  -- ì¬ìƒ/íšŒìƒ (Replay)
  -- ========================================
  is_replayable BOOLEAN DEFAULT false,  -- ë‹¤ì‹œë³´ê¸° ê°€ëŠ¥?
  replay_cost INTEGER DEFAULT 0,        -- ë‹¤ì‹œë³´ê¸° ë¹„ìš© (í† í°)
  replay_count INTEGER DEFAULT 0,       -- ë‹¤ì‹œë³´ê¸° íšŸìˆ˜
  last_replayed_at TIMESTAMPTZ,

  -- ========================================
  -- í‘œì‹œ ì„¤ì • (Display)
  -- ========================================
  is_pinned BOOLEAN DEFAULT false,      -- ê³ ì •ë¨
  is_hidden BOOLEAN DEFAULT false,      -- ìˆ¨ê¹€
  is_favorite BOOLEAN DEFAULT false,    -- ì¦ê²¨ì°¾ê¸°

  -- ========================================
  -- íƒ€ì„ìŠ¤íƒ¬í”„
  -- ========================================
  occurred_at TIMESTAMPTZ DEFAULT NOW(), -- ê¸°ì–µ ë°œìƒ ì‹œì 
  created_at TIMESTAMPTZ DEFAULT NOW(),

  -- ë³µí•© ìœ ë‹ˆí¬ (ê°™ì€ ê¸°ì–µ ì¤‘ë³µ ë°©ì§€)
  UNIQUE(user_id, persona_id, memory_type, title)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_um_user_persona ON user_memories(user_id, persona_id);
CREATE INDEX idx_um_type ON user_memories(memory_type);
CREATE INDEX idx_um_category ON user_memories(memory_category);
CREATE INDEX idx_um_occurred ON user_memories(occurred_at DESC);
CREATE INDEX idx_um_pinned ON user_memories(is_pinned) WHERE is_pinned = true;
```

### 5.3 ì‹ ê·œ í…Œì´ë¸”: `user_journey_stats`

ìœ ì €ì˜ ì „ì²´ ì—¬ì • í†µê³„

```sql
CREATE TABLE user_journey_stats (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE UNIQUE,

  -- ========================================
  -- ì „ì²´ í†µê³„ (Overall Stats)
  -- ========================================
  total_personas_met INTEGER DEFAULT 0,          -- ë§Œë‚œ í˜ë¥´ì†Œë‚˜ ìˆ˜
  total_personas_unlocked INTEGER DEFAULT 0,     -- í•´ê¸ˆí•œ í˜ë¥´ì†Œë‚˜ ìˆ˜
  total_scenarios_completed INTEGER DEFAULT 0,   -- ì™„ë£Œí•œ ì‹œë‚˜ë¦¬ì˜¤ ìˆ˜
  total_memories_created INTEGER DEFAULT 0,      -- ìƒì„±ëœ ê¸°ì–µ ìˆ˜
  total_secrets_discovered INTEGER DEFAULT 0,    -- ë°œê²¬í•œ ë¹„ë°€ ìˆ˜
  total_endings_achieved INTEGER DEFAULT 0,      -- ë‹¬ì„±í•œ ì—”ë”© ìˆ˜
  total_cgs_unlocked INTEGER DEFAULT 0,          -- í•´ê¸ˆí•œ CG ìˆ˜

  -- ========================================
  -- í”Œë ˆì´ í†µê³„ (Play Stats)
  -- ========================================
  total_play_time_minutes INTEGER DEFAULT 0,     -- ì´ í”Œë ˆì´ ì‹œê°„
  total_messages_sent INTEGER DEFAULT 0,         -- ë³´ë‚¸ ë©”ì‹œì§€ ìˆ˜
  total_choices_made INTEGER DEFAULT 0,          -- ì„ íƒ íšŸìˆ˜
  total_premium_choices INTEGER DEFAULT 0,       -- í”„ë¦¬ë¯¸ì—„ ì„ íƒ íšŸìˆ˜

  -- ========================================
  -- ì ‘ì† í†µê³„ (Engagement Stats)
  -- ========================================
  total_login_days INTEGER DEFAULT 0,            -- ì´ ì ‘ì†ì¼
  current_streak_days INTEGER DEFAULT 0,         -- í˜„ì¬ ì—°ì† ì ‘ì†
  max_streak_days INTEGER DEFAULT 0,             -- ìµœëŒ€ ì—°ì† ì ‘ì†
  last_active_date DATE,

  -- ========================================
  -- ì„ í˜¸ë„ (Preferences)
  -- ========================================
  favorite_persona_id TEXT,                      -- ê°€ì¥ ë§ì´ ìƒí˜¸ì‘ìš©í•œ
  most_played_persona_id TEXT,                   -- ê°€ì¥ ì˜¤ë˜ í”Œë ˆì´í•œ
  preferred_play_time TEXT,                      -- ì£¼ ì ‘ì† ì‹œê°„ëŒ€
  -- 'morning', 'afternoon', 'evening', 'night', 'late_night'

  -- ========================================
  -- ì—…ì  (Achievements)
  -- ========================================
  achievements_unlocked TEXT[] DEFAULT '{}',
  achievement_points INTEGER DEFAULT 0,

  -- ========================================
  -- íƒ€ì„ìŠ¤íƒ¬í”„
  -- ========================================
  journey_started_at TIMESTAMPTZ DEFAULT NOW(),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_ujs_user ON user_journey_stats(user_id);
```

### 5.4 ì‹ ê·œ í…Œì´ë¸”: `relationship_milestones`

ë§ˆì¼ìŠ¤í†¤ ì •ì˜ (Origin ë°ì´í„°)

```sql
CREATE TABLE relationship_milestones (
  id TEXT PRIMARY KEY,
  persona_id TEXT REFERENCES personas(id),  -- NULLì´ë©´ ê³µí†µ ë§ˆì¼ìŠ¤í†¤

  -- ========================================
  -- ë§ˆì¼ìŠ¤í†¤ ì •ë³´ (Milestone Info)
  -- ========================================
  milestone_type TEXT NOT NULL,
  -- 'first_meeting'      - ì²« ë§Œë‚¨
  -- 'first_dm'           - ì²« DM
  -- 'became_acquaintance'- ì•„ëŠ” ì‚¬ì´ê°€ ë¨
  -- 'became_friends'     - ì¹œêµ¬ê°€ ë¨
  -- 'first_call'         - ì²« í†µí™”
  -- 'first_date'         - ì²« ë°ì´íŠ¸
  -- 'became_close'       - ê°€ê¹Œìš´ ì‚¬ì´ê°€ ë¨
  -- 'first_confession'   - ì²« ê³ ë°±
  -- 'became_intimate'    - ì—°ì¸ ì§ì „
  -- 'became_lovers'      - ì—°ì¸ì´ ë¨
  -- 'first_anniversary'  - ì²« ê¸°ë…ì¼

  title TEXT NOT NULL,                -- "ì²« ë§Œë‚¨ì˜ ê¸°ì–µ"
  description TEXT,                   -- ë§ˆì¼ìŠ¤í†¤ ì„¤ëª…

  -- ========================================
  -- ë‹¬ì„± ì¡°ê±´ (Requirements)
  -- ========================================
  stage_required TEXT,                -- í•„ìš” ê´€ê³„ ë‹¨ê³„
  affection_required INTEGER DEFAULT 0,
  trust_required INTEGER DEFAULT 0,
  scenarios_required TEXT[] DEFAULT '{}',  -- ì„ í–‰ ì‹œë‚˜ë¦¬ì˜¤

  -- ========================================
  -- ë³´ìƒ (Rewards)
  -- ========================================
  unlocks_scenario_id TEXT,           -- í•´ê¸ˆë˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤
  unlocks_gallery TEXT[] DEFAULT '{}', -- í•´ê¸ˆë˜ëŠ” CG
  unlocks_voice TEXT[] DEFAULT '{}',  -- í•´ê¸ˆë˜ëŠ” ìŒì„±
  unlocks_outfit TEXT,                -- í•´ê¸ˆë˜ëŠ” ì˜ìƒ
  token_reward INTEGER DEFAULT 0,     -- í† í° ë³´ìƒ

  -- ========================================
  -- í‘œì‹œ ì„¤ì • (Display)
  -- ========================================
  icon TEXT,                          -- ì•„ì´ì½˜
  color TEXT,                         -- í…Œë§ˆ ìƒ‰ìƒ
  sort_order INTEGER DEFAULT 0,
  is_hidden BOOLEAN DEFAULT false,    -- íˆë“  ë§ˆì¼ìŠ¤í†¤?

  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_rm_persona ON relationship_milestones(persona_id);
CREATE INDEX idx_rm_type ON relationship_milestones(milestone_type);
CREATE INDEX idx_rm_sort ON relationship_milestones(sort_order);
```

---

## 6. API ì„¤ê³„

### 6.1 ê¸°ì–µ ë©”ë‰´ API

```typescript
// GET /api/memories
// ìœ ì €ì˜ ì „ì²´ ê¸°ì–µ ì¡°íšŒ
interface GetMemoriesResponse {
  journey: {
    totalPersonasMet: number;
    totalMemories: number;
    totalSecrets: number;
    journeyStartedAt: string;
  };
  personas: {
    id: string;
    name: string;
    displayName: string;
    avatarUrl: string;
    progress: number;        // 0-100%
    relationshipStage: string;
    affection: number;
    memoriesCount: number;
    lastInteractionAt: string;
  }[];
}

// GET /api/memories/:personaId
// íŠ¹ì • í˜ë¥´ì†Œë‚˜ì™€ì˜ ê¸°ì–µ ìƒì„¸
interface GetPersonaMemoriesResponse {
  persona: {
    id: string;
    displayName: string;
    avatarUrl: string;
  };
  progress: {
    storyProgress: number;
    relationshipStage: string;
    affection: number;
    trust: number;
    intimacy: number;
    firstMetAt: string;
    totalDays: number;
  };
  milestones: {
    id: string;
    type: string;
    title: string;
    achievedAt: string | null;
    isAchieved: boolean;
  }[];
  memories: {
    id: string;
    type: string;
    title: string;
    summary: string;
    thumbnailUrl: string | null;
    occurredAt: string;
    isPinned: boolean;
    isFavorite: boolean;
  }[];
  timeline: {
    date: string;
    events: {
      type: string;
      title: string;
      memoryId?: string;
    }[];
  }[];
}

// GET /api/memories/:personaId/:memoryId
// ê¸°ì–µ ìƒì„¸ ì¡°íšŒ (ë‹¤ì‹œë³´ê¸°)
interface GetMemoryDetailResponse {
  memory: {
    id: string;
    type: string;
    title: string;
    summary: string;
    fullContent: object;
    thumbnailUrl: string;
    cgUrls: string[];
    voiceUrl: string;
    occurredAt: string;
    affectionAtTime: number;
    relationshipStageAtTime: string;
    isReplayable: boolean;
    replayCost: number;
  };
}
```

### 6.2 í˜ë¥´ì†Œë‚˜ ì§„í–‰ë„ API

```typescript
// GET /api/progress/:personaId
// í˜ë¥´ì†Œë‚˜ì™€ì˜ ì§„í–‰ë„ ìƒì„¸
interface GetProgressResponse {
  relationship: {
    stage: string;
    affection: number;
    trust: number;
    intimacy: number;
    tension: number;
  };
  story: {
    mainProgress: number;
    currentChapter: string;
    chaptersCompleted: string[];
    scenariosCompleted: number;
    scenariosTotal: number;
  };
  unlocks: {
    secrets: { id: string; title: string; unlockedAt: string }[];
    gallery: { id: string; thumbnailUrl: string; unlockedAt: string }[];
    endings: { id: string; title: string; achievedAt: string }[];
  };
  evolution: {
    personalityTraits: { trait: string; level: number }[];
    unlockedSides: string[];
    currentMood: string;
  };
  stats: {
    totalMessages: number;
    totalTime: number;
    firstMetAt: string;
    daysTogether: number;
  };
}
```

---

## 7. ê¸°ì–µ ë©”ë‰´ UI/UX

### 7.1 ë©”ì¸ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ê¸°ì–µ (Memory)                                        [ì„¤ì •]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ“– ë‚˜ì˜ ì—¬ì •                                              â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚  ë§Œë‚œ ìºë¦­í„°  3ëª…  â”‚  ì´ ê¸°ì–µ  47ê°œ  â”‚  ë°œê²¬í•œ ë¹„ë°€  12ê°œ   â”‚ â”‚
â”‚  â”‚  ì‹œì‘ì¼: 2024.10.15  â”‚  í•¨ê»˜í•œ ë‚ : 47ì¼                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  ìºë¦­í„°ë³„ ì§„í–‰ë„                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [IMG]  Jun âœ§ ECLIPSE                           75% â–¶  â”‚  â”‚
â”‚  â”‚         ğŸ’• Intimate  â”‚  â¤ï¸ 82  â”‚  ğŸ“… 47ì¼               â”‚  â”‚
â”‚  â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘                        â”‚  â”‚
â”‚  â”‚         ë§ˆì§€ë§‰ ëŒ€í™”: 2ì‹œê°„ ì „                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [IMG]  Daniel Sterling                         25% â–¶  â”‚  â”‚
â”‚  â”‚         ğŸ¤ Friend  â”‚  â¤ï¸ 34  â”‚  ğŸ“… 12ì¼                 â”‚  â”‚
â”‚  â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                          â”‚  â”‚
â”‚  â”‚         ë§ˆì§€ë§‰ ëŒ€í™”: 3ì¼ ì „                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [ğŸ”’]  Kael                                    LOCKED  â”‚  â”‚
â”‚  â”‚         ì•„ì§ ë§Œë‚˜ì§€ ëª»í•œ ìºë¦­í„°ì…ë‹ˆë‹¤                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ìºë¦­í„° ìƒì„¸ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Junê³¼ì˜ ê¸°ì–µ                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    [Jun í”„ë¡œí•„ ì´ë¯¸ì§€]                     â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚              Jun âœ§ ECLIPSE  âœ“                            â”‚ â”‚
â”‚  â”‚              ğŸ’• Intimate (ì—°ì¸ ì§ì „)                       â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚    â¤ï¸ í˜¸ê°ë„        ğŸ¤ ì‹ ë¢°ë„        ğŸ’‹ ì¹œë°€ë„            â”‚ â”‚
â”‚  â”‚       82              78              65                  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚              ğŸ“… í•¨ê»˜í•œ ì§€ 47ì¼                             â”‚ â”‚
â”‚  â”‚              ğŸ’¬ ë‚˜ëˆˆ ëŒ€í™” 1,247íšŒ                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  [ë§ˆì¼ìŠ¤í†¤] [ê¸°ì–µ] [ê°¤ëŸ¬ë¦¬] [í†µê³„]                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                 â”‚
â”‚  ë§ˆì¼ìŠ¤í†¤ (5/8 ë‹¬ì„±)                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â”‚  âœ… ì²« ë§Œë‚¨              2024.10.15                           â”‚
â”‚  âœ… ì²« DM ëŒ€í™”           2024.10.16                           â”‚
â”‚  âœ… ì¹œêµ¬ê°€ ë˜ë‹¤          2024.10.25  â”‚  ğŸ CG í•´ê¸ˆ            â”‚
â”‚  âœ… ë¹„ë°€ì„ ê³µìœ í•˜ë‹¤      2024.11.02  â”‚  ğŸ ë³´ì´ìŠ¤ í•´ê¸ˆ         â”‚
â”‚  âœ… ê°€ê¹Œì›Œì§€ë‹¤           2024.11.15  â”‚  ğŸ ìŠ¤í˜ì…œ ì‹œë‚˜ë¦¬ì˜¤     â”‚
â”‚  ğŸ”’ ì²« ê³ ë°±              ???         â”‚  â¤ï¸ í˜¸ê°ë„ 85 í•„ìš”     â”‚
â”‚  ğŸ”’ ì—°ì¸ì´ ë˜ë‹¤          ???         â”‚  â¤ï¸ í˜¸ê°ë„ 95 í•„ìš”     â”‚
â”‚  ğŸ”’ ???                  ???         â”‚  íˆë“  ë§ˆì¼ìŠ¤í†¤          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ê¸°ì–µ íƒ€ì„ë¼ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ë§ˆì¼ìŠ¤í†¤] [ê¸°ì–µ] [ê°¤ëŸ¬ë¦¬] [í†µê³„]                               â”‚
â”‚            â•â•â•â•â•â•                                              â”‚
â”‚                                                                 â”‚
â”‚  ê¸°ì–µ íƒ€ì„ë¼ì¸                                    [ì „ì²´] [ì¦ê²¨ì°¾ê¸°]â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“… 2024ë…„ 12ì›”                                                â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ 12.03  ğŸ’• "ìƒˆë²½ì˜ ê³ ë°±"                            [â­][â–¶]â”‚
â”‚  â”‚         ê¸´ ì¹¨ë¬µ ëì—, ì¤€ì´ ì…ì„ ì—´ì—ˆë‹¤...                   â”‚
â”‚  â”‚         [CG ì¸ë„¤ì¼]                                        â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ 12.01  ğŸ—¨ï¸ "ì½˜ì„œíŠ¸ ë’·ì´ì•¼ê¸°"                        [  ][â–¶]â”‚
â”‚  â”‚         ë¬´ëŒ€ ë’¤ì—ì„œ ë‚˜ëˆˆ ì§„ì†”í•œ ëŒ€í™”                        â”‚
â”‚  â”‚                                                             â”‚
â”‚  ğŸ“… 2024ë…„ 11ì›”                                                â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ 11.28  ğŸ˜¢ "ìš°ë¦¬ì˜ ì²« ë‹¤íˆ¼"                          [â­][â–¶]â”‚
â”‚  â”‚         ì‚¬ì†Œí•œ ì˜¤í•´ë¡œ ì‹œì‘ëœ ê°ˆë“±...                        â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ 11.25  ğŸ¤« "ì•„ë¬´ë„ ëª¨ë¥´ëŠ” ë¹„ë°€"                      [  ][â–¶]â”‚
â”‚  â”‚         ì¤€ì´ ì²˜ìŒìœ¼ë¡œ ìì‹ ì˜ ì´ì•¼ê¸°ë¥¼ í„¸ì–´ë†“ì•˜ë‹¤            â”‚
â”‚  â”‚         [CG ì¸ë„¤ì¼]                                        â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ 11.15  ğŸ‰ "ê°€ê¹Œì›Œì§€ë‹¤" (ë§ˆì¼ìŠ¤í†¤)                   [ğŸ“Œ][â–¶]â”‚
â”‚  â”‚         ê´€ê³„ê°€ í•œ ë‹¨ê³„ ë°œì „í–ˆë‹¤!                           â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”‚  ... ë”ë³´ê¸°                                                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš

### 8.1 ë§ˆì´ê·¸ë ˆì´ì…˜ ìˆœì„œ

```
Phase 1: ìŠ¤í‚¤ë§ˆ í™•ì¥ (í•˜ìœ„í˜¸í™˜ ìœ ì§€)
â”œâ”€â”€ Step 1.1: user_persona_progress í…Œì´ë¸” ìƒì„±
â”œâ”€â”€ Step 1.2: user_memories í…Œì´ë¸” ìƒì„±
â”œâ”€â”€ Step 1.3: user_journey_stats í…Œì´ë¸” ìƒì„±
â””â”€â”€ Step 1.4: relationship_milestones í…Œì´ë¸” ìƒì„±

Phase 2: ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
â”œâ”€â”€ Step 2.1: user_persona_relationships â†’ user_persona_progress ë³µì‚¬
â”œâ”€â”€ Step 2.2: persona_memories â†’ user_memories ë³µì‚¬
â””â”€â”€ Step 2.3: í†µê³„ ë°ì´í„° ê³„ì‚° ë° user_journey_stats ìƒì„±

Phase 3: ì½”ë“œ ì—…ë°ì´íŠ¸
â”œâ”€â”€ Step 3.1: API ë¼ìš°íŠ¸ ì¶”ê°€/ìˆ˜ì •
â”œâ”€â”€ Step 3.2: AI Agent ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ ì—°ë™
â””â”€â”€ Step 3.3: í”„ë¡ íŠ¸ì—”ë“œ ê¸°ì–µ ë©”ë‰´ êµ¬í˜„

Phase 4: ì •ë¦¬
â”œâ”€â”€ Step 4.1: ê¸°ì¡´ í…Œì´ë¸” deprecation ë§ˆí‚¹
â””â”€â”€ Step 4.2: ë°ì´í„° ì •í•©ì„± ê²€ì¦
```

### 8.2 ë¡¤ë°± ì „ëµ

```
ê° Phaseë³„ ë¡¤ë°± ê°€ëŠ¥:
- Phase 1: DROP TABLEìœ¼ë¡œ ì¦‰ì‹œ ë¡¤ë°±
- Phase 2: ì›ë³¸ ë°ì´í„° ë³´ì¡´ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì•ˆì „
- Phase 3: ê¸°ì¡´ API ìœ ì§€í•˜ë©´ì„œ ìƒˆ API ì¶”ê°€í–ˆìœ¼ë¯€ë¡œ ì½”ë“œ revert
```

---

## 9. êµ¬í˜„ ë¡œë“œë§µ

### Phase 1: ë°ì´í„°ë² ì´ìŠ¤ (1-2ì¼)

| Task | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|----------|
| 1.1 | `user_persona_progress` í…Œì´ë¸” ìƒì„± | ğŸ”´ í•„ìˆ˜ |
| 1.2 | `user_memories` í…Œì´ë¸” ìƒì„± | ğŸ”´ í•„ìˆ˜ |
| 1.3 | `user_journey_stats` í…Œì´ë¸” ìƒì„± | ğŸŸ¡ ì¤‘ìš” |
| 1.4 | `relationship_milestones` í…Œì´ë¸” ìƒì„± | ğŸŸ¡ ì¤‘ìš” |
| 1.5 | ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ | ğŸ”´ í•„ìˆ˜ |

### Phase 2: ë°±ì—”ë“œ API (2-3ì¼)

| Task | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|----------|
| 2.1 | GET /api/memories êµ¬í˜„ | ğŸ”´ í•„ìˆ˜ |
| 2.2 | GET /api/memories/:personaId êµ¬í˜„ | ğŸ”´ í•„ìˆ˜ |
| 2.3 | GET /api/memories/:personaId/:memoryId êµ¬í˜„ | ğŸŸ¡ ì¤‘ìš” |
| 2.4 | GET /api/progress/:personaId êµ¬í˜„ | ğŸ”´ í•„ìˆ˜ |
| 2.5 | ê¸°ì¡´ /api/dm/* ìˆ˜ì • | ğŸ”´ í•„ìˆ˜ |

### Phase 3: AI ì‹œìŠ¤í…œ ì—°ë™ (2-3ì¼)

| Task | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|----------|
| 3.1 | AI Agentì—ì„œ ìƒˆ í…Œì´ë¸” ì‚¬ìš© | ğŸ”´ í•„ìˆ˜ |
| 3.2 | ê¸°ì–µ ìë™ ìƒì„± ë¡œì§ êµ¬í˜„ | ğŸ”´ í•„ìˆ˜ |
| 3.3 | ë§ˆì¼ìŠ¤í†¤ ë‹¬ì„± ì²´í¬ ë¡œì§ | ğŸŸ¡ ì¤‘ìš” |
| 3.4 | í˜ë¥´ì†Œë‚˜ ì§„í™” ë¡œì§ | ğŸŸ¢ ë‚˜ì¤‘ì— |

### Phase 4: í”„ë¡ íŠ¸ì—”ë“œ (3-5ì¼)

| Task | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|----------|
| 4.1 | ê¸°ì–µ ë©”ë‰´ ë©”ì¸ í™”ë©´ | ğŸ”´ í•„ìˆ˜ |
| 4.2 | ìºë¦­í„°ë³„ ìƒì„¸ í™”ë©´ | ğŸ”´ í•„ìˆ˜ |
| 4.3 | ê¸°ì–µ íƒ€ì„ë¼ì¸ | ğŸŸ¡ ì¤‘ìš” |
| 4.4 | ë§ˆì¼ìŠ¤í†¤ í™”ë©´ | ğŸŸ¡ ì¤‘ìš” |
| 4.5 | ê¸°ì–µ ë‹¤ì‹œë³´ê¸° | ğŸŸ¢ ë‚˜ì¤‘ì— |

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 2024-12-03 | 2.0 | ì „ì²´ ì•„í‚¤í…ì²˜ ì¬ì„¤ê³„, Origin/Instance ë¶„ë¦¬ |
| 2024-12-03 | 1.0 | ì´ˆê¸° ë¬¸ì„œ ì‘ì„± |
